<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dashboard | Flashcard Revision</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(120deg, #f8fafc 0%, #e0e7ff 100%);
        }
        /* Animated background circles */
        
        .bg-anim-circle {
            position: absolute;
            border-radius: 9999px;
            z-index: 0;
        }
        
        .bg-anim-blue {
            top: -60px;
            left: -60px;
            width: 320px;
            height: 320px;
            background: #c7d2fe;
            opacity: 0.25;
            animation: pulse-slow 3.5s ease-in-out infinite;
        }
        
        .bg-anim-yellow {
            bottom: -80px;
            right: -80px;
            width: 400px;
            height: 400px;
            background: #fef9c3;
            opacity: 0.18;
            animation: pulse-slow 3.5s 1.5s ease-in-out infinite;
        }
        
        @keyframes pulse-slow {
            0%,
            100% {
                transform: scale(1);
                opacity: 0.25;
            }
            50% {
                transform: scale(1.12);
                opacity: 0.4;
            }
        }
        /* --- Refine Uiverse-inspired deck effect: keep color inside the deck --- */
        
        .e-card {
            width: 220px;
            height: 220px;
            position: relative;
            overflow: hidden;
            border-radius: 1em;
            box-shadow: 0 8px 32px 0 rgba(80, 80, 160, 0.10), 0 2px 8px 0 rgba(80, 80, 160, 0.08);
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 16px 32px 16px;
            animation: fade-in-up 1.1s cubic-bezier(.25, 1.7, .45, .87);
            z-index: 0;
            transition: box-shadow 0.3s, background 0.3s, transform 0.3s;
        }
        
        .e-card:hover,
        .e-card:focus-within {
            box-shadow: 0 16px 48px 0 rgba(80, 80, 160, 0.18), 0 8px 24px 0 rgba(80, 80, 160, 0.14);
            transform: translateY(-12px) scale(1.04);
        }
        
        .e-card .deck-circle {
            position: absolute;
            height: 5em;
            width: 5em;
            top: 50%;
            left: -2.5em;
            transform: translateY(-50%) scale(1);
            border-radius: 50%;
            z-index: 0;
            background: var(--deck-circle, #38bdf8);
            transition: left 0.7s cubic-bezier(.4, 1.4, .6, 1), transform 0.7s cubic-bezier(.4, 1.4, .6, 1), background 0.5s;
        }
        
        .e-card:hover .deck-circle,
        .e-card:focus-within .deck-circle {
            left: calc(100% - 2.5em);
            background: var(--deck-circle-hover, #0ea5e9);
            transform: translateY(-50%) scale(1.7);
        }
        
        .e-card a {
            width: 100%;
            height: 100%;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 1em;
            color: var(--deck-text, #2563eb);
            background: transparent;
            font-weight: bold;
            z-index: 1;
            position: relative;
            transition: color 0.5s;
        }
        
        .e-card:hover a,
        .e-card:focus-within a {
            color: #fff;
        }
        
        .e-card .deck-title {
            position: relative;
            z-index: 2;
            font-weight: bold;
            font-size: 1.4em;
            font-family: 'Poppins', sans-serif;
            transition: color 0.5s;
            color: var(--deck-text, #2563eb);
        }
        
        .e-card:hover .deck-title,
        .e-card:focus-within .deck-title {
            color: #fff;
        }
        /* Deck color themes */
        
        .e-card.dbms {
            --deck-circle: #38bdf8;
            --deck-circle-hover: #2563eb;
            --deck-text: #2563eb;
        }
        
        .e-card.java {
            --deck-circle: #34d399;
            --deck-circle-hover: #059669;
            --deck-text: #047857;
        }
        
        .e-card.ipcv {
            --deck-circle: #a78bfa;
            --deck-circle-hover: #7c3aed;
            --deck-text: #7c3aed;
        }
        
        .e-card.data-analysis {
            --deck-circle: #fbbf24;
            --deck-circle-hover: #f59e42;
            --deck-text: #b45309;
        }
        
        .e-card.probability-theory {
            --deck-circle: #f87171;
            --deck-circle-hover: #dc2626;
            --deck-text: #b91c1c;
        }
        
        @keyframes fade-in-up {
            0% {
                opacity: 0;
                transform: translateY(40px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @media (max-width: 900px) {
            .e-card {
                width: 150px;
                height: 150px;
            }
        }
        
        @media (max-width: 600px) {
            .e-card {
                width: 100%;
                height: 100px;
            }
        }
        
        header.bg-blue-600 {
            background: linear-gradient(90deg, #6366f1 60%, #60a5fa 100%);
        }
        
        footer {
            background: #e0e7ff;
            color: #4b5563;
        }
        /* Animation for fade-in-up */
        
        @keyframes fade-in-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fade-in-up {
            animation: fade-in-up 0.8s ease-out forwards;
        }
        /* Astronaut Card Animation */
        
        .card {
            position: relative;
            width: 19em;
            height: 25em;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #171717;
            color: white;
            font-family: Montserrat, sans-serif;
            font-weight: bold;
            padding: 1em 2em 1em 1em;
            border-radius: 20px;
            overflow: hidden;
            z-index: 1;
            row-gap: 1em;
        }
        
        .card img {
            width: 12em;
            margin-right: 1em;
            animation: move 10s ease-in-out infinite;
            z-index: 5;
        }
        
        .image:hover {
            cursor: -webkit-grab;
            cursor: grab;
        }
        
        .icons svg {
            width: 20px;
            height: 20px;
        }
        
        .card::before {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            inset: -3px;
            border-radius: 10px;
            background: radial-gradient(#858585, transparent, transparent);
            transform: translate(-5px, 250px);
            transition: 0.4s ease-in-out;
            z-index: -1;
        }
        
        .card:hover::before {
            width: 150%;
            height: 100%;
            margin-left: -4.25em;
        }
        
        .card::after {
            content: "";
            position: absolute;
            inset: 2px;
            border-radius: 20px;
            background: rgb(23, 23, 23, 0.7);
            transition: all 0.4s ease-in-out;
            z-index: -1;
        }
        
        .heading {
            z-index: 2;
            transition: 0.4s ease-in-out;
        }
        
        .card:hover .heading {
            letter-spacing: 0.025em;
        }
        
        .heading::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 2px;
            border-radius: 50%;
            opacity: 1;
            box-shadow: 220px 118px #fff, 280px 176px #fff, 40px 50px #fff, 60px 180px #fff, 120px 130px #fff, 180px 176px #fff, 220px 290px #fff, 520px 250px #fff, 400px 220px #fff, 50px 350px #fff, 10px 230px #fff;
            z-index: -1;
            transition: 1s ease;
            animation: 1s glowing-stars linear alternate infinite;
            animation-delay: 0s;
        }
        
        .icons::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 2px;
            border-radius: 50%;
            opacity: 1;
            box-shadow: 140px 20px #fff, 425px 20px #fff, 70px 120px #fff, 20px 130px #fff, 110px 80px #fff, 280px 80px #fff, 250px 350px #fff, 280px 230px #fff, 220px 190px #fff, 450px 100px #fff, 380px 80px #fff, 520px 50px #fff;
            z-index: -1;
            transition: 1.5s ease;
            animation: 1s glowing-stars linear alternate infinite;
            animation-delay: 0.4s;
        }
        
        .icons::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 2px;
            border-radius: 50%;
            opacity: 1;
            box-shadow: 490px 330px #fff, 420px 300px #fff, 320px 280px #fff, 380px 350px #fff, 546px 170px #fff, 420px 180px #fff, 370px 150px #fff, 200px 250px #fff, 80px 20px #fff, 190px 50px #fff, 270px 20px #fff, 120px 230px #fff, 350px -1px #fff, 150px 369px #fff;
            z-index: -1;
            transition: 2s ease;
            animation: 1s glowing-stars linear alternate infinite;
            animation-delay: 0.8s;
        }
        
        .card:hover .heading::before,
        .card:hover .icons::before,
        .card:hover .icons::after {
            filter: blur(3px);
        }
        
        .image:active {
            cursor: -webkit-grabbing;
            cursor: grabbing;
        }
        
        .image:active+.heading::before {
            box-shadow: 240px 20px #9b40fc, 240px 25px #9b40fc, 240px 30px #9b40fc, 240px 35px #9b40fc, 240px 40px #9b40fc, 242px 45px #9b40fc, 246px 48px #9b40fc, 251px 49px #9b40fc, 256px 48px #9b40fc, 260px 45px #9b40fc, 262px 40px #9b40fc;
            animation: none;
            filter: blur(0);
            border-radius: 2px;
            width: 0.45em;
            height: 0.45em;
            scale: 0.65;
            transform: translateX(9em) translateY(1em);
        }
        
        .image:active~.icons::before {
            box-shadow: 262px 35px #9b40fc, 262px 30px #9b40fc, 262px 25px #9b40fc, 262px 20px #9b40fc, 275px 20px #9b40fc, 275px 24px #9b40fc, 275px 28px #9b40fc, 275px 32px #9b40fc, 275px 36px #9b40fc, 275px 40px #9b40fc, 275px 44px #9b40fc, 275px 48px #9b40fc;
            animation: none;
            filter: blur(0);
            border-radius: 2px;
            width: 0.45em;
            height: 0.45em;
            scale: 0.65;
            transform: translateX(9em) translateY(1em);
        }
        
        .image:active~.icons::after {
            box-shadow: 238px 60px #9b40fc, 242px 60px #9b40fc, 246px 60px #9b40fc, 250px 60px #9b40fc, 254px 60px #9b40fc, 258px 60px #9b40fc, 262px 60px #9b40fc, 266px 60px #9b40fc, 270px 60px #9b40fc, 274px 60px #9b40fc, 278px 60px #9b40fc, 282px 60px #9b40fc, 234px 60px #9b40fc, 234px 60px #9b40fc;
            animation: none;
            filter: blur(0);
            border-radius: 2px;
            width: 0.45em;
            height: 0.45em;
            scale: 0.65;
            transform: translateX(9em) translateY(1.25em);
        }
        
        .heading::after {
            content: "";
            top: -8.5%;
            left: -8.5%;
            position: absolute;
            width: 7.5em;
            height: 7.5em;
            border: none;
            outline: none;
            border-radius: 50%;
            background: #f9f9fb;
            box-shadow: 0px 0px 100px rgba(193, 119, 241, 0.8), 0px 0px 100px rgba(135, 42, 211, 0.8), inset #9b40fc 0px 0px 40px -12px;
            transition: 0.4s ease-in-out;
            z-index: -1;
        }
        
        .card:hover .heading::after {
            box-shadow: 0px 0px 200px rgba(193, 119, 241, 1), 0px 0px 200px rgba(135, 42, 211, 1), inset #9b40fc 0px 0px 40px -12px;
        }
        
        .icons {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: row;
            column-gap: 1em;
            z-index: 1;
        }
        
        .instagram,
        .x,
        .discord {
            position: relative;
            transition: 0.4s ease-in-out;
        }
        
        .instagram:after,
        .x:after,
        .discord:after {
            content: "";
            position: absolute;
            width: 0.5em;
            height: 0.5em;
            left: 0;
            background-color: white;
            box-shadow: 0px 0px 10px rgba(233, 233, 233, 0.5), 0px 0px 10px rgba(192, 192, 192, 0.5);
            border-radius: 50%;
            z-index: -1;
            transition: 0.3s ease-in-out;
        }
        
        .instagram svg path,
        .x svg path,
        .discord svg path {
            stroke: #808080;
            transition: 0.4s ease-in-out;
        }
        
        .instagram:hover svg path {
            stroke: #cc39a4;
        }
        
        .x:hover svg path {
            stroke: black;
        }
        
        .discord:hover svg path {
            stroke: #8c9eff;
        }
        
        .instagram svg,
        .x svg,
        .discord svg {
            transition: 0.3s ease-in-out;
        }
        
        .instagram:hover svg {
            scale: 1.4;
        }
        
        .x:hover svg,
        .discord:hover svg {
            scale: 1.25;
        }
        
        .instagram:hover:after,
        .x:hover:after,
        .discord:hover:after {
            scale: 4;
            transform: translateX(0.09em) translateY(0.09em);
        }
        
        .instagram::before {
            content: "";
            position: absolute;
            top: -700%;
            left: 1050%;
            rotate: -45deg;
            width: 5em;
            height: 1px;
            background: linear-gradient(90deg, #ffffff, transparent);
            animation: 4s shootingStar ease-in-out infinite;
            transition: 1s ease;
            animation-delay: 1s;
        }
        
        .x::before {
            content: "";
            position: absolute;
            top: -1300%;
            left: 850%;
            rotate: -45deg;
            width: 5em;
            height: 1px;
            background: linear-gradient(90deg, #ffffff, transparent);
            animation: 4s shootingStar ease-in-out infinite;
            animation-delay: 3s;
        }
        
        .discord::before {
            content: "";
            position: absolute;
            top: -2100%;
            left: 850%;
            rotate: -45deg;
            width: 5em;
            height: 1px;
            background: linear-gradient(90deg, #ffffff, transparent);
            animation: 4s shootingStar ease-in-out infinite;
            animation-delay: 5s;
        }
        
        .card:hover .instagram::before,
        .card:hover .x::before,
        .card:hover .discord::before {
            filter: blur(3px);
        }
        
        .image:active~.icons .instagram::before,
        .image:active~.icons .x::before,
        .image:active~.icons .discord::before {
            animation: none;
            opacity: 0;
        }
        
        @keyframes shootingStar {
            0% {
                transform: translateX(0) translateY(0);
                opacity: 1;
            }
            50% {
                transform: translateX(-55em) translateY(0);
                opacity: 1;
            }
            70% {
                transform: translateX(-70em) translateY(0);
                opacity: 0;
            }
            100% {
                transform: translateX(0) translateY(0);
                opacity: 0;
            }
        }
        
        @keyframes move {
            0% {
                transform: translateX(0em) translateY(0em);
            }
            25% {
                transform: translateY(-1em) translateX(-1em);
                rotate: -10deg;
            }
            50% {
                transform: translateY(1em) translateX(-1em);
            }
            75% {
                transform: translateY(-1.25em) translateX(1em);
                rotate: 10deg;
            }
            100% {
                transform: translateX(0em) translateY(0em);
            }
        }
        
        @keyframes glowing-stars {
            0% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }
        /* Navbar button styles */
        
        .nav-btn {
            background: #2563eb;
            color: #fff;
            padding: 0.5em 1.2em;
            border-radius: 8px;
            font-weight: 500;
            transition: background 0.3s, transform 0.3s;
            display: inline-block;
            margin: 0.5em 0;
        }
        
        .nav-btn:hover {
            background: #22d3ee;
            transform: translateY(-2px);
        }
        
        .nav-btn-dbms {
            background: linear-gradient(90deg, #e0e7ff 60%, #c7d2fe 100%);
            color: #1e3a8a;
            border-radius: 8px;
            font-weight: 600;
            box-shadow: 0 2px 8px 0 rgba(80, 80, 160, 0.08);
            padding: 0.5em 1.2em;
            margin: 0.5em 0;
            transition: background 0.3s, color 0.3s, box-shadow 0.3s, transform 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .nav-btn-dbms:hover,
        .nav-btn-dbms:focus {
            background: linear-gradient(90deg, #c7d2fe 60%, #569af8 100%);
            color: #2563eb;
            box-shadow: 0 4px 16px 0 rgba(59, 130, 246, 0.18), 0 2px 8px 0 rgba(59, 130, 246, 0.14);
            transform: translateY(-2px) scale(1.04);
            letter-spacing: 0.5px;
        }
        
        .e-card.dbms:hover .deck-title,
        .e-card.dbms:focus-within .deck-title,
        .e-card.java:hover .deck-title,
        .e-card.java:focus-within .deck-title,
        .e-card.ipcv:hover .deck-title,
        .e-card.ipcv:focus-within .deck-title,
        .e-card.data-analysis:hover .deck-title,
        .e-card.data-analysis:focus-within .deck-title,
        .e-card.probability-theory:hover .deck-title,
        .e-card.probability-theory:focus-within .deck-title {
            color: #111 !important;
            transition: color 0.5s;
        }
        /* Streak Counter Animations */
        
        .streak-hero-anim {
            box-shadow: 0 8px 32px 0 rgba(251, 191, 36, 0.18), 0 2px 8px 0 rgba(251, 191, 36, 0.12);
            transition: box-shadow 0.4s, transform 0.4s, border-color 0.4s;
        }
        
        .streak-hero-anim:hover {
            box-shadow: 0 16px 48px 0 rgba(251, 191, 36, 0.28), 0 8px 24px 0 rgba(251, 191, 36, 0.18);
            border-color: #facc15;
            background: linear-gradient(120deg, #fef08a 0%, #fde047 100%);
            transform: scale(1.08) rotate(-2deg);
        }
        
        .streak-fire-anim {
            display: inline-block;
            animation: streak-fire-pop 1.2s cubic-bezier(.25, 1.7, .45, .87) infinite alternate;
        }
        
        @keyframes streak-fire-pop {
            0% {
                transform: scale(1) rotate(-2deg);
                filter: drop-shadow(0 0 0 #facc15);
            }
            60% {
                transform: scale(1.12) rotate(2deg);
                filter: drop-shadow(0 0 8px #fde047);
            }
            100% {
                transform: scale(1.08) rotate(-2deg);
                filter: drop-shadow(0 0 12px #facc15);
            }
        }
    </style>
</head>

<body class="min-h-screen h-screen flex flex-col relative overflow-hidden">
    <div class="bg-anim-circle bg-anim-blue"></div>
    <div class="bg-anim-circle bg-anim-yellow"></div>
    <!-- Header -->
    <header class="bg-white shadow-lg p-4 flex flex-col md:flex-row md:justify-between md:items-center relative z-10 transition-all duration-300">
        <div class="flex flex-col md:flex-row md:items-center w-full">
            <h1 id="subjectTitle" class="text-xl font-bold flex-1 text-center md:text-left text-blue-700">Flashcard Revision Dashboard</h1>
            <nav class="flex flex-wrap justify-center md:justify-end gap-2 mt-2 md:mt-0 w-full md:w-auto">
                <a href="dashboard.html" class="nav-btn nav-btn-dbms">Dashboard</a>
                <a href="leaderboard.html" class="nav-btn nav-btn-dbms">Leaderboard</a>
                <a href="profile.html" class="nav-btn nav-btn-dbms">Profile</a>
            </nav>
            <div class="flex flex-col md:flex-row md:items-center gap-2 mt-2 md:mt-0 ml-0 md:ml-6">
                <span id="welcomeUser" class="text-base font-medium text-blue-700"></span>
                <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 text-white font-semibold px-4 py-2 rounded transition-colors duration-200">Logout</button>
            </div>
        </div>
    </header>

    <!-- Scrollable Content (Hero + Main) -->
    <div class="flex-grow overflow-auto">
        <!-- Hero Section -->
        <section class="w-full flex flex-col md:flex-row items-center justify-center py-12 mb-8 relative z-10 gap-4 px-2 md:px-0">
            <div class="flex-1 flex flex-col items-center md:items-start justify-center pl-8 md:pl-24">
                <h2 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-4 text-center md:text-left animate-fade-in-up">
                    Why Should One Choose Revision Flashcard?
                </h2>
                <p class="text-lg md:text-xl text-gray-600 max-w-2xl text-center md:text-left mb-2 animate-fade-in-up delay-100 pl-2">
                    Revision flashcards are a proven, interactive way to boost memory retention, reinforce learning, and make studying more engaging. With our modern flashcard platform, you can track your progress, focus on weak areas, and revise efficiently‚Äîanytime, anywhere.
                </p>
            </div>
            <div class="flex-1 flex justify-center items-center">
                <!-- Streak Counter Replaces Astronaut Image -->
                <div id="streakCounterHero" class="flex flex-col items-center justify-center bg-gradient-to-br from-yellow-100 via-yellow-200 to-yellow-100 rounded-2xl shadow-xl px-10 py-12 animate-fade-in-up border-4 border-yellow-300 transition-all duration-300 transform hover:scale-105 hover:shadow-2xl hover:border-yellow-400 streak-hero-anim cursor-pointer">
                    <div class="text-7xl font-extrabold text-yellow-500 mb-2 streak-fire-anim" id="heroStreakValue">üî• 0</div>
                    <div class="text-xl font-bold text-yellow-800 mb-1">Current Streak</div>
                    <div class="text-base text-gray-700">Days in a row</div>
                </div>
            </div>
        </section>

        <!-- Main Content -->
        <main class="p-8 pt-0 md:pt-0">
            <h2 class="text-2xl md:text-3xl font-semibold text-sky-800 mb-6 text-center animate-fade-in-up bg-gradient-to-r from-sky-100 via-sky-200 to-sky-100 rounded-lg px-6 py-3 shadow-md w-full" style="margin-top:-1.5rem;">
                Select a Subject to Start Revising
            </h2>

            <div class="flex flex-col items-center">
                <div class="flex justify-center mb-8">
                    <div class="e-card dbms playing">
                        <div class="deck-circle"></div>
                        <a href="subject.html?subject=dbms" class="block font-bold cursor-pointer deck-title">DBMS</a>
                    </div>
                    <div class="e-card java playing">
                        <div class="deck-circle"></div>
                        <a href="subject.html?subject=java" class="block font-bold cursor-pointer deck-title">Java</a>
                    </div>
                    <div class="e-card ipcv playing">
                        <div class="deck-circle"></div>
                        <a href="subject.html?subject=ipcv" class="block font-bold cursor-pointer deck-title">IPCV</a>
                    </div>
                </div>
                <div class="flex justify-center">
                    <div class="e-card data-analysis playing">
                        <div class="deck-circle"></div>
                        <a href="subject.html?subject=data-analysis" class="block font-bold cursor-pointer deck-title">Data Analysis</a>
                    </div>
                    <div class="e-card probability-theory playing">
                        <div class="deck-circle"></div>
                        <a href="subject.html?subject=probability-theory" class="block font-bold cursor-pointer deck-title">Probability Theory</a>
                    </div>
                </div>
            </div>

            <!-- WOW Section: Replace Go Crazy with something awesome -->
            <section id="wowSection" class="w-full flex flex-col items-center justify-center gap-8 mt-12 mb-8 animate-fade-in-up">
                <div class="w-full md:w-2/3 bg-gradient-to-br from-blue-100 via-green-100 to-yellow-100 rounded-2xl shadow-2xl p-10 flex flex-col items-center border-4 border-blue-200 relative overflow-hidden wow-card min-h-[320px] min-w-[320px]">
                    <div class="text-6xl mb-4 animate-bounce">üöÄ</div>
                    <div class="font-extrabold text-3xl text-blue-700 mb-4 text-center">Your Study Journey So Far</div>
                    <div id="wowStats" class="w-full flex flex-wrap justify-center gap-6 mb-6 min-h-[80px]"></div>
                    <div class="w-full flex justify-center mb-4">
                        <a href="daily-quiz.html" id="dailyQuizBtn" class="bg-purple-600 hover:bg-purple-800 text-white font-bold px-6 py-3 rounded-xl shadow-lg transition-all text-lg flex items-center gap-2">
                            <span>üéØ</span> Daily Quiz
                        </a>
                    </div>
                    <div id="wowQuote" class="text-lg text-green-800 text-center font-semibold mt-2 min-h-[32px]"></div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Check user login
        const user = JSON.parse(localStorage.getItem('loggedInUser'));
        if (!user) {
            alert('Please login first.');
            window.location.href = 'login.html';
        }

        // Display welcome message
        document.getElementById('welcomeUser').textContent = `Welcome, ${user.username}!`;

        // Logout button
        document.getElementById('logoutBtn').addEventListener('click', () => {
            localStorage.removeItem('loggedInUser');
            window.location.href = 'index.html';
        });

        // --- Dynamic Progress Cards ---
        // Fetch real user progress from backend
        async function loadUserProgress() {
            const progressCards = document.getElementById('progressCards');
            const progressPercent = document.getElementById('progressPercent');
            const progressCardsCount = document.getElementById('progressCardsCount');
            const progressBar = document.getElementById('progressBar');
            const progressStreak = document.getElementById('progressStreak');
            if (progressCards) progressCards.innerHTML = '';
            let totalReviewed = 0;
            let totalCards = 0;
            try {
                const resp = await fetch('http://localhost:5000/api/user/progress', {
                    credentials: 'include',
                });
                if (!resp.ok) throw new Error('Not logged in or failed to fetch progress.');
                const data = await resp.json();
                if (!Array.isArray(data) || data.length === 0) {
                    if (progressPercent) progressPercent.textContent = '0%';
                    if (progressCardsCount) progressCardsCount.textContent = '0 / 0 cards reviewed';
                    if (progressBar) progressBar.style.width = '0%';
                    if (progressStreak) progressStreak.textContent = 'üî• 0';
                    return;
                }
                // Calculate total reviewed and total cards
                data.forEach(subj => {
                    // Support both camelCase and snake_case from backend
                    const reviewed = subj.reviewedFlashcards !== undefined ? subj.reviewedFlashcards : (subj.reviewed_flashcards !== undefined ? subj.reviewed_flashcards : 0);
                    const total = subj.totalFlashcards !== undefined ? subj.totalFlashcards : (subj.total_flashcards !== undefined ? subj.total_flashcards : 0);
                    totalReviewed += reviewed;
                    totalCards += total;
                });
                const percent = totalCards > 0 ? Math.round((totalReviewed / totalCards) * 100) : 0;
                if (progressPercent) progressPercent.textContent = percent + '%';
                if (progressCardsCount) progressCardsCount.textContent = `${totalReviewed} / ${totalCards} cards reviewed`;
                if (progressBar) progressBar.style.width = percent + '%';
                // Dynamic streak calculation (localStorage based)
                let streak = parseInt(localStorage.getItem('reviseStreak') || '0', 10);
                let lastDay = localStorage.getItem('reviseLastDay');
                const today = new Date().toISOString().slice(0, 10);
                if (lastDay !== today) {
                    // Calculate UTC day difference
                    const last = lastDay ? Date.UTC(parseInt(lastDay.slice(0, 4)), parseInt(lastDay.slice(5, 7)) - 1, parseInt(lastDay.slice(8, 10))) : null;
                    const curr = Date.UTC(parseInt(today.slice(0, 4)), parseInt(today.slice(5, 7)) - 1, parseInt(today.slice(8, 10)));
                    let diffDays = last ? Math.floor((curr - last) / 86400000) : null;
                    if (lastDay && diffDays === 1) {
                        streak++;
                    } else {
                        streak = 1;
                    }
                    localStorage.setItem('reviseStreak', streak);
                    localStorage.setItem('reviseLastDay', today);
                }
                if (progressStreak) progressStreak.textContent = `üî• ${streak}`;
                // ...existing code for subject progress cards...
                const subjectMeta = {
                    'DBMS': {
                        color: 'from-blue-200 via-blue-300 to-blue-200',
                        icon: 'üíæ'
                    },
                    'Java': {
                        color: 'from-green-200 via-green-300 to-green-200',
                        icon: '‚òï'
                    },
                    'IPCV': {
                        color: 'from-purple-200 via-purple-300 to-purple-200',
                        icon: 'üß†'
                    },
                    'Data Analysis': {
                        color: 'from-yellow-100 via-yellow-200 to-yellow-100',
                        icon: 'üìä'
                    },
                    'Probability Theory': {
                        color: 'from-red-200 via-red-300 to-red-200',
                        icon: 'üé≤'
                    }
                };
                data.forEach(subj => {
                    const meta = subjectMeta[subj.subjectName] || {
                        color: 'from-gray-100 via-gray-200 to-gray-100',
                        icon: 'üìö'
                    };
                    const reviewed = subj.reviewedFlashcards !== undefined ? subj.reviewedFlashcards : (subj.reviewed_flashcards !== undefined ? subj.reviewed_flashcards : 0);
                    const total = subj.totalFlashcards !== undefined ? subj.totalFlashcards : (subj.total_flashcards !== undefined ? subj.total_flashcards : 0);
                    const percent = total > 0 ? Math.round((reviewed / total) * 100) : 0;
                    const card = document.createElement('div');
                    card.className = `w-64 bg-gradient-to-r ${meta.color} rounded-xl shadow-lg p-6 flex flex-col items-center animate-fade-in-up`;
                    card.innerHTML = `
                        <div class="text-4xl mb-2">${meta.icon}</div>
                        <div class="font-bold text-lg mb-2 text-gray-800">${subj.subjectName ?? subj.subject_name}</div>
                        <div class="w-full bg-gray-200 rounded-full h-4 mb-2">
                            <div class="h-4 rounded-full transition-all duration-700" style="width:${percent}%; background: linear-gradient(90deg, #38bdf8 60%, #2563eb 100%);"></div>
                        </div>
                        <div class="text-sm font-semibold text-gray-700">${percent}% Complete (${reviewed} / ${total} cards)</div>
                    `;
                    if (progressCards) progressCards.appendChild(card);
                });
            } catch (err) {
                if (progressPercent) progressPercent.textContent = '0%';
                if (progressCardsCount) progressCardsCount.textContent = '0 / 0 cards reviewed';
                if (progressBar) progressBar.style.width = '0%';
                if (progressStreak) progressStreak.textContent = 'üî• 0';
            }
        }
        loadUserProgress();

        // --- Real-time Streak Counter for Hero Section ---
        function updateHeroStreak() {
            let streak = parseInt(localStorage.getItem('reviseStreak') || '0', 10);
            let lastDay = localStorage.getItem('reviseLastDay');
            const today = new Date().toISOString().slice(0, 10);
            // Recalculate streak if needed (robust UTC logic)
            if (lastDay !== today) {
                const last = lastDay ? Date.UTC(parseInt(lastDay.slice(0, 4)), parseInt(lastDay.slice(5, 7)) - 1, parseInt(lastDay.slice(8, 10))) : null;
                const curr = Date.UTC(parseInt(today.slice(0, 4)), parseInt(today.slice(5, 7)) - 1, parseInt(today.slice(8, 10)));
                let diffDays = last ? Math.floor((curr - last) / 86400000) : null;
                if (lastDay && diffDays === 1) {
                    streak++;
                } else {
                    streak = 1;
                }
                localStorage.setItem('reviseStreak', streak);
                localStorage.setItem('reviseLastDay', today);
            }
            document.getElementById('heroStreakValue').textContent = `üî• ${streak}`;
        }
        updateHeroStreak();
        // Optionally, update every minute in case user leaves tab open overnight
        setInterval(updateHeroStreak, 60000);

        // --- WOW Section: Awesome Study Stats & Motivation ---
        function renderWowSection() {
            // Defensive: ensure elements exist before using
            const wowStats = document.getElementById('wowStats');
            const wowQuote = document.getElementById('wowQuote');
            if (!wowStats || !wowQuote) return;
            // Gather stats from localStorage (fallback if backend not available)
            let loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
            let totalCards = 0,
                totalChapters = 0,
                subjects = 0,
                streak = 0;
            let progressKey = loggedInUser ? `progress_${loggedInUser.email}` : null;
            let progressData = progressKey ? JSON.parse(localStorage.getItem(progressKey)) || {} : {};
            subjects = Object.keys(progressData).length;
            for (const subject in progressData) {
                for (const chapter in progressData[subject]) {
                    totalCards += progressData[subject][chapter];
                    totalChapters++;
                }
            }
            streak = parseInt(localStorage.getItem('reviseStreak') || '0', 10);
            // Build stat cards only if there is progress
            wowStats.innerHTML = '';
            const stats = [{
                icon: 'üìö',
                label: 'Subjects Studied',
                value: subjects
            }, {
                icon: 'üìñ',
                label: 'Chapters Reviewed',
                value: totalChapters
            }, {
                icon: 'üìù',
                label: 'Cards Reviewed',
                value: totalCards
            }, {
                icon: 'üî•',
                label: 'Current Streak',
                value: streak + ' days'
            }];
            let hasProgress = subjects > 0 || totalChapters > 0 || totalCards > 0 || streak > 0;
            if (hasProgress) {
                stats.forEach(s => {
                    const card = document.createElement('div');
                    card.className = 'flex flex-col items-center bg-white rounded-xl shadow-md p-6 min-w-[120px]';
                    card.innerHTML = `<div class="text-3xl mb-1">${s.icon}</div><div class="text-lg font-bold text-blue-700">${s.value}</div><div class="text-sm text-gray-500 mt-1">${s.label}</div>`;
                    wowStats.appendChild(card);
                });
            } else {
                wowStats.innerHTML = '<div class="text-gray-500 text-lg font-semibold text-center w-full">Start revising to see your awesome stats here!</div>';
            }
            // Motivational quote
            const quotes = [
                "Every card you review is a step closer to mastery!",
                "Consistency beats intensity. Keep showing up!",
                "Your future self will thank you for today's effort.",
                "Learning is a journey, not a race. Enjoy every step!",
                "Great things are done by a series of small things brought together. ‚Äî Van Gogh",
                "You are building your brain, one flashcard at a time!",
                "The secret to getting ahead is getting started.",
                "Progress, not perfection!"
            ];
            wowQuote.textContent = quotes[Math.floor(Math.random() * quotes.length)];
        }
        document.addEventListener('DOMContentLoaded', renderWowSection);

        // --- WOW Section: Replace AI Insights & Motivation with something new and crazy ---
        // Remove the old AI Insights and Motivation logic
        // Add a crazy, animated confetti celebration and a random fun fact generator!
        function launchConfetti() {
            // Simple confetti using emoji
            const confettiContainer = document.createElement('div');
            confettiContainer.style.position = 'fixed';
            confettiContainer.style.left = 0;
            confettiContainer.style.top = 0;
            confettiContainer.style.width = '100vw';
            confettiContainer.style.height = '100vh';
            confettiContainer.style.pointerEvents = 'none';
            confettiContainer.style.zIndex = 9999;
            const emojis = ['üéâ', '‚ú®', 'üéä', 'ü™Ö', 'üí•', 'üåà', '‚≠ê', 'ü•≥'];
            for (let i = 0; i < 80; i++) {
                const conf = document.createElement('div');
                conf.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                conf.style.position = 'absolute';
                conf.style.left = Math.random() * 100 + 'vw';
                conf.style.top = '-5vh';
                conf.style.fontSize = (Math.random() * 2 + 1) + 'rem';
                conf.style.transition = 'top 2.5s cubic-bezier(.2,1.2,.4,1), transform 2.5s';
                setTimeout(() => {
                    conf.style.top = (Math.random() * 80 + 10) + 'vh';
                    conf.style.transform = `rotate(${Math.random()*360}deg)`;
                }, 50);
                confettiContainer.appendChild(conf);
            }
            document.body.appendChild(confettiContainer);
            setTimeout(() => {
                confettiContainer.remove();
            }, 3000);
        }

        // Fun Fact Generator
        const funFacts = [
            "Honey never spoils. Archaeologists have eaten 3000-year-old honey! üçØ",
            "Bananas are berries, but strawberries aren't. Mind blown! üçåüçì",
            "A group of flamingos is called a 'flamboyance'. ü¶©",
            "Octopuses have three hearts. ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è",
            "There are more stars in the universe than grains of sand on Earth. ‚ú®",
            "Wombat poop is cube-shaped. üü´",
            "The unicorn is the national animal of Scotland. ü¶Ñ",
            "You can't hum while holding your nose closed. Try it! ü§≠",
            "Some cats are allergic to humans. üòπ",
            "A day on Venus is longer than a year on Venus. ü™ê"
        ];

        function showRandomFact() {
            const factBox = document.getElementById('crazyFactBox');
            if (factBox) {
                factBox.textContent = funFacts[Math.floor(Math.random() * funFacts.length)];
            }
        }
        // Add event to crazy button
        document.addEventListener('DOMContentLoaded', function() {
            const crazyBtn = document.getElementById('crazyBtn');
            if (crazyBtn) {
                crazyBtn.onclick = function() {
                    launchConfetti();
                    showRandomFact();
                };
            }
            showRandomFact();
        });
    </script>
</body>

</html>